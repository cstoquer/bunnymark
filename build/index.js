!function o(s,a,h){function u(e,t){if(!a[e]){if(!s[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(l)return l(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var n=a[e]={exports:{}};s[e][0].call(n.exports,function(t){return u(s[e][1][t]||t)},n,n.exports,o,s,a,h)}return a[e].exports}for(var l="function"==typeof require&&require,t=0;t<h.length;t++)u(h[t]);return u}({1:[function(t,e,r){var s=/rgba?\(\s*([.0-9]+)\s*,\s*([.0-9]+)\s*,\s*([.0-9]+)\s*,?\s*([.0-9]+)?\s*\)/;function i(){this.r=0,this.g=0,this.b=0,this.a=void 0,this.string=""}(e.exports=i).prototype._setRGB=function(t,e,r){this.r=t,this.g=e,this.b=r},i.prototype.fromPixel=function(t,e){var r=t[e+0],i=t[e+1],n=t[e+2];return this.string="rgb("+r+","+i+","+n+")",this._setRGB(r,i,n),this},i.prototype.fromString=function(t){var e,r,i,n=(this.string=t).match(s);if(n)e=~~n[1],r=~~n[2],i=~~n[3],this._setRGB(e,r,i);else{var o="0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&");this._setRGB(o>>16,o>>8&255,255&o)}return this},i.prototype.fromRGB=function(t,e,r){return this._setRGB(t,e,r),this.string="rgb("+t+","+e+","+r+")",this},i.prototype.fromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this.string=t.string,this}},{}],2:[function(t,e,r){function i(t,e){this.width=t,this.height=e,this.camera={x:0,y:0},this._cursor={i:0,j:0},this._paper=0,this._pen=1,this._init()}function n(t,e){t.ox=0,t.oy=0,e._isImageWrapper&&(e=e.asset),e._isSprite?(t.ox=e.x,t.oy=e.y,t.tilesheet=e.img):e._isMap?(e.texture||e._prepareTexture(),t.tilesheet=e.texture.canvas):e._isTexture?t.tilesheet=e.canvas:(e instanceof Image||e instanceof HTMLCanvasElement)&&(t.tilesheet=e)}(e.exports=i).prototype.palette=[{string:"#000000",r:0,g:0,b:0},{string:"#FFFFFF",r:1,g:1,b:1}],i.prototype.ox=0,i.prototype.oy=0,i.setTileSize=function(){},i.prototype.setPalette=function(t){i.prototype.palette=t},i.prototype.setGlobalTilesheet=function(t){n(i.prototype,t)},i.prototype.setTilesheet=function(t){if(t)return n(this,t),this;delete this.tilesheet},i.prototype.setCamera=function(t,e){return this.camera.x=t||0,this.camera.y=e||0,this}},{}],3:[function(t,e,r){var i=t("./index.js"),u=t("../domUtils/createCanvas"),v=t("../webGL/batcher"),g=v.renderers,m=4,x=6,b=0,w=0,l=[0,8338,45,11962,5588,21157,29354,10,17556,5265,21973,1488,5312,448,13824,5268,31599,29843,29671,31143,18925,31183,31689,18735,31727,18927,1040,5136,17492,3640,5393,8359,25450,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25750,17553,13459,9402,28672,34,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25686,9362,13587,42,21845];var n=function(){var t=u(64,36),e=t.getContext("2d");e.fillStyle="#000",e.fillRect(0,0,64,36),e.fillStyle="#FFF";for(var r=0;r<l.length;r++)for(var i=l[r],n=r%16,o=~~(r/16),s=0;s<15;s++){var a=s%3,h=~~(s/3);1==(i>>s&1)&&e.fillRect(n*m+a,o*x+h,1,1)}return t}(),_=n,o=i.prototype.resize;i.prototype.resize=function(t,e){return this._textColumn=~~(t/m),this._textLine=~~(e/x),this._textPadding=e-this._textLine*x,this._cursor.i=0,this._cursor.j=0,o.call(this,t,e),this};var s=i.prototype.cls;i.prototype.cls=function(){return s.call(this),this.locate(0,0),this},i.prototype.locate=function(t,e){return this._cursor.i=~~t,this._cursor.j=~~e,this},i.prototype.print=function(e,t,r){if("object"==typeof e)try{e=JSON.stringify(e)}catch(t){e="[Object]"}else"string"!=typeof e&&(e=e.toString());var i=v.prepare(g.colorSprite,_,this),n=this.palette[this._pen],o=n.r,s=n.g,a=n.b;if(void 0!==t){t=~~Math.round(t-this.camera.x),r=~~Math.round(r-this.camera.y);for(var h=t,u=0;u<e.length;u++){if(10!==(d=e.charCodeAt(u))&&13!==d)if((d-=32)<0||255<d)t+=m;else{var l=m*(d%16)+b,f=x*~~(d/16)+w;i.pushSprite(t,r,m,x,l,f,o,s,a),t+=m}else r+=x,t=h}return this}u=this._cursor.i;for(var c=this._cursor.j,p=0;p<e.length;p++){var d;if(u>this._textColumn&&(c+=1,u=0),c>this._textLine&&(this.textScroll(),--c,i=v.prepare(g.colorSprite,_,this)),10!==(d=e.charCodeAt(p))&&13!==d)if((d-=32)<0||255<d)u+=1;else{l=m*(d%16)+b,f=x*~~(d/16)+w;i.pushSprite(u*m,c*x,m,x,l,f,o,s,a),u+=1}else c+=1,u=0}return this._cursor.i=u,this._cursor.j=c,this},i.prototype.println=function(t){return this.print(t),this.print("\n"),this},i.prototype.textScroll=function(t){return void 0===t&&(t=1),this._cursor.j-=t,t*=x,this._copyTexture||(this._copyTexture=new i(this.width,this.height)),this._copyTexture.draw(this,0,0),this.cls(),this.draw(this._copyTexture,0,-t),this},i.prototype.setCharset=function(t){m=~~((_=t||n).width/16),x=~~(_.height/6),w=b=0,_._isSprite&&(b=_.x,w=_.y,_=_.img),this._textColumn=~~(this.width/m)-1,this._textLine=~~(this.height/x)-1,this._textPadding=this.height-this._textLine*x}},{"../domUtils/createCanvas":8,"../webGL/batcher":15,"./index.js":2}],4:[function(t,e,r){var f=t("./index.js"),i=t("../webGL/context"),c=t("../webGL/batcher"),n=i.gl,p=c.renderers,o=t("..").settings,h=~~o.tileSize.width,u=~~o.tileSize.height;function s(t,e){if(t.ox=0,t.oy=0,e._isImageWrapper&&(e=e.asset),e._isSprite)t.ox=e.x,t.oy=e.y,t.tilesheet=e.img;else{if(e._isMap)throw new Error("TileMap cannot be used as tilesheet if using webGL");e._isTexture?t.tilesheet=e.canvas:(e._isGlTexture||e instanceof Image||e instanceof HTMLCanvasElement)&&(t.tilesheet=e)}}f.prototype._init=function(){if(0===this.width||0===this.height)return this.ctx=null,void(this.framebuffer=null);this.ctx=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.ctx),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),this.framebuffer=n.createFramebuffer(),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.ctx,0)},f.prototype.setCamera=function(t,e){return this.camera.x=t||0,this.camera.y=e||0,this},f.prototype.sprite=function(t,e,r,i,n,o){if(e=Math.round((e||0)-this.camera.x),r=Math.round((r||0)-this.camera.y),e>=this.width||r>=this.height||e<=-h||r<=-u)return this;var s=t%16*h+this.ox,a=u*~~(t/16)+this.oy;return c.prepare(p.sprite,this.tilesheet,this).pushSprite(e,r,h,u,s,a,i,n,o),this},f.prototype.draw=function(t,e,r,i,n,o){if(t===this&&(this._copyTexture||(this._copyTexture=new f(this.width,this.height)),this._copyTexture.draw(this,0,0),t=this._copyTexture),t._isTileMap)return t._draw(e,r,i,n,o,this),this;if(e=Math.round((e||0)-this.camera.x),r=Math.round((r||0)-this.camera.y),e>=this.width||r>=this.height)return this;if(t._isSprite){var s=t;t=s.img;var a=s.x,h=s.y,u=s.width,l=s.height;if(e<=-u||r<=-l)return this;c.prepare(p.sprite,t,this).pushSprite(e,r,u,l,a,h,i,n,o)}else{if(e<=-t.width||r<=-t.height)return this;c.prepare(p.sprite,t,this).pushSprite(e,r,t.width,t.height,0,0,i,n,o)}return this},f.prototype.clear=function(){return c.flush(),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer),n.viewport(0,0,this.width,this.height),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),this},f.prototype.cls=function(){var t=this.palette[this._paper];return c.flush(),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer),n.viewport(0,0,this.width,this.height),n.clearColor(t.r/255,t.g/255,t.b/255,1),n.clear(n.COLOR_BUFFER_BIT),this},f.prototype.paper=function(t){return this._paper=t%this.palette.length,this},f.prototype.pen=function(t){return this._pen=t%this.palette.length,this},f.prototype.setTilesheet=function(t){if(t)return s(this,t),this;delete this.tilesheet},f.prototype.setGlobalTilesheet=function(t){s(f.prototype,t)},window.tilesheet=function(t){return f.prototype.setGlobalTilesheet(t)},window.texture=function(t){var e=new f(t.width,t.height);return e.clear().draw(t,0,0),e},f.prototype.rect=function(t,e,r,i){var n=this.palette[this._pen],o=c.prepare(p.color,null,this);return r<=2||i<=2?o.pushRect(t,e,r,i,n.r,n.g,n.b):(o.pushRect(t,e,r,1,n.r,n.g,n.b),o.pushRect(t,e+i-1,r,1,n.r,n.g,n.b),o.pushRect(t,e,1,i,n.r,n.g,n.b),o.pushRect(t+r-1,e,1,i,n.r,n.g,n.b)),this},f.prototype.rectf=function(t,e,r,i){var n=this.palette[this._paper];return c.prepare(p.color,null,this).pushRect(t,e,r,i,n.r,n.g,n.b),this},f.prototype.rectfill=f.prototype.rectf,f.prototype.resize=function(t,e){return this.width===t&&this.height===e||(this.width=t,this.height=e,this._init(),this._copyTexture&&(this._copyTexture=null)),this},f.prototype._isTexture=!0,f.prototype._isGlTexture=!0},{"..":11,"../webGL/batcher":15,"../webGL/context":16,"./index.js":2}],5:[function(t,e,r){var i=t("../Texture"),n=t(".."),u=8,l=8;function f(t,e,r,i,n,o,s,a){this.x=~~t,this.y=~~e,this.sprite=~~r,this.flipH=!!i,this.flipV=!!n,this.flipR=!!o,this.flagA=!!s,this.flagB=!!a}function o(t,e){this._name="",this.width=0,this.height=0,this.items=[],this.texture=null,this.tilesheet=null,this._tilesheetPath="",t&&e&&this._init(t,e)}(e.exports=o).prototype._isTileMap=!0;var a,p,s={},h=[];o.getMap=function(t){return"string"==typeof t?s[t]:"number"==typeof t?h[t]:(console.error("Map does not exist",t),null)},o._checkBankFormat=function(t){return t?Array.isArray(t)?{_type:"maps",maps:t}:"maps"!==t._type?(console.warn("Map bank format incorrect"),{_type:"maps",maps:[]}):t:{_type:"maps",maps:[]}},o.loadBank=function(t){t=o._checkBankFormat(t),s={},h=[];for(var e=t.maps||[],r=0;r<e.length;r++)h.push((new o).load(e[r]))},o.setTileSize=function(t,e){u=~~t,l=~~e},Object.defineProperty(o.prototype,"name",{get:function(){return this._name},set:function(t){this._name&&s[this._name]&&s[this._name]===this&&delete s[this._name],(this._name=t)&&!s[t]&&(s[t]=this)}}),o.prototype._init=function(t,e){this.width=t,this.height=e,this.items=[];for(var r=0;r<t;r++){this.items.push([]);for(var i=0;i<e;i++)this.items[r][i]=null}this.texture&&this.texture.resize(t*u,e*l)},o.prototype.resize=function(t,e){var r=this.items,i=Math.min(this.width,t),n=Math.min(this.height,e);this._init(t,e);for(var o=0;o<i;o++)for(var s=0;s<n;s++)this.items[o][s]=r[o][s];return this.redraw(),this},o.prototype.set=function(t,e,r,i,n,o,s,a){if(null==r)return this.remove(t,e);if(!(t<0||e<0||t>=this.width||e>=this.height)){var h=this.items[t][e]=new f(t,e,r,i,n,o,s,a);return this.texture&&(this.texture.ctx.clearRect(t*u,e*l,u,l),this.texture.sprite(h.sprite,h.x*u,h.y*l,h.flipH,h.flipV,h.flipR)),this}},o.prototype.remove=function(t,e){if(!(t<0||e<0||t>=this.width||e>=this.height))return this.items[t][e]=null,this.texture&&this.texture.ctx.clearRect(t*u,e*l,u,l),this},o.prototype.get=function(t,e){return t<0||e<0||t>=this.width||e>=this.height?null:this.items[t][e]},o.prototype.redraw=function(){if(!this.texture)return this;this.texture.clear();for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++){var r=this.items[t][e];r&&this.texture.sprite(r.sprite,r.x*u,r.y*l,r.flipH,r.flipV,r.flipR)}return this},o.prototype._prepareTexture=function(){this.texture=new i(this.width*u,this.height*l),this.texture.setTilesheet(this.tilesheet),this.redraw()},o.prototype.release=function(){this.texture=null},o.prototype.draw=function(t,e){this.texture||this._prepareTexture(),draw(this.texture,t,e)},o.prototype.setTilesheet=function(t){return this.tilesheet=t,this._tilesheetPath=t&&t.path||"",this.texture&&(this.texture.setTilesheet(t),this.redraw()),this},o.prototype._setTilesheetPath=function(t){if(this._tilesheetPath=t||"",!t)return this.setTilesheet();for(var e=t.split("/"),r=n.assets||{},i=0;i<e.length;i++)if(!(r=r[e[i]]))return console.warn("Could not find tilesheet",t);this.setTilesheet(r)},function(){for(var r="#$%&'()*+,-~/0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}. !",u={},t=0;t<r.length;t++)u[r[t]]=t;var l=r.length,f=l*l-1,c=Math.pow(2,13),o=f-c-1;function s(t){var e=t%l;return r[~~(t/l)]+r[e]}a=function(t){for(var e="",r=0,i=0;i<t.length;i++){var n=t[i];n===t[i+1]&&++r<o||(null===n&&(n=f),e+=s(n),r===o&&r--,0!==r&&(e+=s(c+r)),r=0)}return r===o&&r--,0!==r&&(e+=s(c+r)),e},p=function(t){for(var e=[],r=0;r<t.length;){var i=t[r++],n=t[r++],o=u[i]*l+u[n];if(o===f)e.push(null);else if(c<o)for(var s=o-c,a=e[e.length-1],h=0;h<s;h++)e.push(a);else e.push(o)}return e}}(),o.prototype.save=function(){for(var t=this.width,e=this.height,r=new Array(t*e),i=0;i<t;i++)for(var n=0;n<e;n++){var o=this.items[i][n];r[i+n*t]=o?o.sprite+(o.flipH<<8)+(o.flipV<<9)+(o.flipR<<10)+(o.flagA<<11)+(o.flagB<<12):null}return{w:t,h:e,name:this.name,sheet:this._tilesheetPath||"",data:a(r)}},o.prototype.load=function(t){this.texture=null;var e=t.w,r=t.h;this._init(e,r),this.name=t.name||"",this._setTilesheetPath(t.sheet);for(var i=p(t.data),n=0;n<e;n++)for(var o=0;o<r;o++){var s=i[n+o*e];if(null!==s){var a=255&s,h=s>>8&1,u=s>>9&1,l=s>>10&1,f=s>>11&1,c=s>>12&1;this.set(n,o,a,h,u,l,f,c)}}return this},o.prototype.copy=function(t,e,r,i){t=t||0,e=e||0,null==r&&(r=this.width),null==i&&(i=this.height);var n=new o(r,i);return n.paste(this,-t,-e),n},o.prototype.paste=function(t,e,r,i){e=e||0,r=r||0;for(var n=Math.min(t.width,this.width-e),o=Math.min(t.height,this.height-r),s=Math.max(0,-e),a=Math.max(0,-r),h=s;h<n;h++)for(var u=a;u<o;u++){var l=t.items[h][u];if(l)this.set(h+e,u+r,l.sprite,l.flipH,l.flipV,l.flipR,l.flagA,l.flagB);else{if(i)continue;this.remove(h+e,u+r)}}return this},o.prototype.clear=function(){for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++)this.items[t][e]=null;return this.texture&&this.texture.clear(),this},o.prototype.find=function(t,e,r){if(null===t)return this._findNull();void 0===e&&(e=null),void 0===r&&(r=null);for(var i=[],n=0;n<this.width;n++)for(var o=0;o<this.height;o++){var s=this.items[n][o];if(s){var a=null===e||s.flagA===e,h=null===r||s.flagB===r;s.sprite===t&&a&&h&&i.push(s)}}return i},o.prototype._findNull=function(){for(var t=[],e=0;e<this.width;e++)for(var r=0;r<this.height;r++)null===this.items[e][r]&&t.push({x:e,y:r});return t}},{"..":11,"../Texture":2}],6:[function(t,e,r){var i=t("./index.js"),D=t("../Texture"),I=t("../webGL/batcher"),M=t(".."),n=M.settings,U=n.tileSize.width,P=n.tileSize.height,G=n.screen.width,N=n.screen.height,V=I.renderers.sprite,H={false:{false:{false:{flipH:!1,flipV:!1,flipR:!0},true:{flipH:!0,flipV:!0,flipR:!1}},true:{false:{flipH:!0,flipV:!1,flipR:!0},true:{flipH:!1,flipV:!0,flipR:!1}}},true:{false:{false:{flipH:!1,flipV:!0,flipR:!0},true:{flipH:!0,flipV:!1,flipR:!1}},true:{false:{flipH:!0,flipV:!0,flipR:!0},true:{flipH:!1,flipV:!1,flipR:!1}}}};i.prototype._prepareTexture=function(){},i.prototype.release=function(){},i.prototype.redraw=function(){},i.prototype.draw=function(t,e,r,i,n){this._draw(t,e,r,i,n,M.$screen)},i.prototype._draw=function(t,e,r,i,n,o){var s=this.tilesheet||D.prototype.tilesheet,a=I.prepare(V,s,o),h=M.$screen.camera;t=Math.round((t||0)-h.x),e=Math.round((e||0)-h.y);var u=this.tilesheet||assets.tilesheet,l=0,f=0;if(u._isSprite&&(l=u.x,f=u.y),r||i||n){var c,p;p=n?(c=this.height,this.width):(c=this.width,this.height);for(var d=Math.max(0,~~(-t/U)),v=Math.max(0,~~(-e/P)),g=Math.min(c,~~(1+(G-t)/U)),m=Math.min(p,~~(1+(N-e)/P)),x=v;x<m;x++)for(var b=d;b<g;b++){var w,_;if(_=n?(w=x,this.height-1-b):(w=b,x),r&&(w=this.width-1-w),i&&(_=this.height-1-_),F=this.get(w,_)){var y,T,E,R=(L=F.sprite)%16*U+l,A=~~(L/16)*P+f,S=t+b*U,C=e+x*P;if(n){var B=H[F.flipH][F.flipV][F.flipR];y=B.flipH,T=B.flipV,E=B.flipR,r&&(T=!T),i&&(y=!y)}else y=F.flipH,T=F.flipV,E=F.flipR,r&&(y=!y),i&&(T=!T);a.pushSprite(S,C,U,P,R,A,y,T,E)}}}else for(d=Math.max(0,~~(-t/U)),v=Math.max(0,~~(-e/P)),g=Math.min(this.width,~~(1+(G-t)/U)),m=Math.min(this.height,~~(1+(N-e)/P)),x=v;x<m;x++)for(b=d;b<g;b++){var F;if(F=this.get(b,x)){var L;R=(L=F.sprite)%16*U+l,A=~~(L/16)*P+f,S=t+b*U,C=e+x*P;a.pushSprite(S,C,U,P,R,A,F.flipH,F.flipV,F.flipR)}}},e.exports=i},{"..":11,"../Texture":2,"../webGL/batcher":15,"./index.js":5}],7:[function(t,e,r){function p(t,e){var r=new Image;r.onload=function(){this.onload=null,this.onerror=null,e&&e(null,this)},r.onerror=function(){this.onload=null,this.onerror=null,e&&e("img:"+t)},r.src=t}function d(t,e){var r=new Audio;function i(){e&&e(null,r),r.removeEventListener("canplaythrough",i),r.removeEventListener("error",n)}function n(){e&&e("snd:load"),r.removeEventListener("canplaythrough",i),r.removeEventListener("error",n)}r.preload=!0,r.loop=!1,r.addEventListener("canplaythrough",i),r.addEventListener("error",n),r.src=t,r.load()}r.loadData=function(t,e,r){var i=new XMLHttpRequest;i.responseType=e||"arraybuffer",i.onreadystatechange=function(){if(4==~~i.readyState)return 200!=~~i.status&&0!=~~i.status?r&&r("xhrError:"+i.status):r&&r(null,i.response)},i.open("GET",t,!0),i.send()},r.loadJson=function(t,e){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==~~r.readyState)return 200!=~~r.status?e("xhrError:"+r.status):e&&e(null,JSON.parse(r.response))},r.open("GET",t,!0),r.send()},r.loadImage=p,r.loadSound=d,r.preloadStaticAssets=function(i,n,o){var a=i.dat,s=i.img.length,h=s+i.snd.length,u=i.root,l=0,f=0;function c(){var r,t,e=l+f;o&&o(l,e,h,e/h),t=e<s?(r=i.img[e],p):(r=i.snd[e-s],d),f+=1,t(u+r,function(t,e){t||function(t,e){var r=t.split("/"),i=r.pop().split(".");i.pop(),i=i.join(".");for(var n=a,o=0,s=r.length;o<s;o++)n=n[r[o]];n[i]=e,r.push(i),e.name=i,e.path=r.join("/")}(r,e),(l+=1)+--f<h?c():0===f&&n(null,a)})}if(0===h)return n(null,a);for(var t=Math.min(5,h-1),e=0;e<=t;e++)c()}},{}],8:[function(t,e,r){e.exports=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,r}},{}],9:[function(t,e,r){var n=document.body;function i(e,t){var r=document;rect=e.getBoundingClientRect();var i=t.clientX-rect.left,n=t.clientY-rect.top;function o(t){t.preventDefault(),e.style.left=t.clientX-i+"px",e.style.top=t.clientY-n+"px"}r.addEventListener("mousemove",o,!1),r.addEventListener("mouseup",function t(e){e.preventDefault(),r.removeEventListener("mouseup",t),r.removeEventListener("mousemove",o)},!1)}r.createDom=function(t,e,r){r=r||n;var i=document.createElement(t);return r.appendChild(i),e&&(i.className=e),i},r.createDiv=function(t,e){return r.createDom("div",t,e)},r.removeDom=function(t,e){(e=e||n).removeChild(t)},r.makeClickable=function(e,r){return e.addEventListener("mousedown",function(t){t.stopPropagation(),t.preventDefault(),r.call(e,t)}),e},r.makeDragable=function(t,e){return e=e||t,t.addEventListener("mousedown",function(t){t.stopPropagation(),t.preventDefault(),i(e,t)}),t},r.addCss=function(t){var e=document.createElement("style");e.type="text/css";var r=document.createTextNode(t);return e.appendChild(r),document.head.appendChild(e),e},r.addCssRef=function(t){var e=document.createElement("link");return e.href=t,e.rel="stylesheet",e.type="text/css",document.head.appendChild(e),e}},{}],10:[function(t,e,r){var f=["A","B","X","Y","lb","rb","lt","rt","back","start","lp","rp","up","down","left","right"],i=!(!navigator||!navigator.getGamepads),c=!1,p=.2;function n(){this.available=!1,this.btn={},this.btnp={},this.btnr={},this.x=0,this.y=0,this.z=0,this.w=0,this.lt=0,this.rt=0,this._setupButtons()}n.prototype._setupButtons=function(){for(var t=0;t<f.length;t++){var e=f[t];this.btn[e]=!1,this.btnp[e]=!1,this.btnr[e]=!1}};var d=[new n,new n,new n,new n,window],o=new n;var s=i?function(){for(var t=navigator.getGamepads(),e=0;e<4;e++){var r=t[e],i=d[e];if(r){var n,o,s,a;i.available=!0,c&&(n=i.btn.right,o=i.btn.left,a=i.btn.down,s=i.btn.up);for(var h=0;h<f.length;h++){var u=f[h],l=r.buttons[h].pressed;i.btnp[u]=!i.btn[u]&&l,i.btnr[u]=i.btn[u]&&!l,i.btn[u]=l}i.x=r.axes[0],i.y=r.axes[1],i.z=r.axes[2],i.w=r.axes[3],i.lt=r.buttons[6].value,i.rt=r.buttons[7].value,c&&(i.btn.right=i.btn.right||i.x>p,i.btn.left=i.btn.left||i.x<-p,i.btn.down=i.btn.down||i.y>p,i.btn.up=i.btn.up||i.y<-p,i.btnp.right=i.btn.right&&!n,i.btnp.left=i.btn.left&&!o,i.btnp.down=i.btn.down&&!a,i.btnp.up=i.btn.up&&!s,i.btnr.right=!i.btn.right&&n,i.btnr.left=!i.btn.left&&o,i.btnr.down=!i.btn.down&&a,i.btnr.up=!i.btn.up&&s)}else i.available=!1}return d}:function(){return d};r.mapAnalogStickToDpad=function(t){c=!0,p=void 0===t?.3:t},r.update=function(){window.gamepads=s(),window.gamepad=function(){for(var t=0;t<f.length;t++){var e=f[t];o.btnp[e]=btnp[e]||d[0].btnp[e]||d[1].btnp[e]||d[2].btnp[e]||d[3].btnp[e],o.btnr[e]=btnr[e]||d[0].btnr[e]||d[1].btnr[e]||d[2].btnr[e]||d[3].btnr[e],o.btn[e]=btn[e]||d[0].btn[e]||d[1].btn[e]||d[2].btn[e]||d[3].btn[e]}return o.btn.up&&o.btn.down&&(o.btn.down=!1),o.btn.right&&o.btn.left&&(o.btn.left=!1),o}()}},{}],11:[function(t,e,r){e.exports={}},{}],12:[function(t,e,r){e.exports=function(t,e){t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}},{}],13:[function(t,e,r){var i=t("./context").gl;function n(t){this.uShortView=new Uint16Array(t),this.binder=i.createBuffer(),this.length=0,this.vertexIndice=0}(e.exports=n).prototype.uploadData=function(){i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.binder),i.bufferData(i.ELEMENT_ARRAY_BUFFER,this.uShortView,i.STATIC_DRAW)},n.prototype.bindBuffer=function(){i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.binder)},n.prototype.reset=function(){this.length=0,this.vertexIndice=0}},{"./context":16}],14:[function(t,e,r){var i=t("./context").gl;function n(t){this.arrayBuffer=new ArrayBuffer(t),this.floatView=new Float32Array(this.arrayBuffer),this.uLongView=new Uint32Array(this.arrayBuffer),this.longView=new Int32Array(this.arrayBuffer),this.uShortView=new Uint16Array(this.arrayBuffer),this.shortView=new Int16Array(this.arrayBuffer),this.byteView=new Uint8Array(this.arrayBuffer),this.uByteView=new Int8Array(this.arrayBuffer),this.binder=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.binder)}(e.exports=n).prototype.uploadData=function(){i.bindBuffer(i.ARRAY_BUFFER,this.binder),i.bufferData(i.ARRAY_BUFFER,this.arrayBuffer,i.DYNAMIC_DRAW)}},{"./context":16}],15:[function(t,e,r){var i=t("./context"),n=t("./VertexBuffer"),o=t("./IndexBuffer"),s=t("./renderers/sprite"),a=t("./renderers/line"),h=t("./renderers/colorQuad"),u=t("./renderers/colorSprite"),l=i.gl;function f(){this._renderer=s,this._program=null,this._renderTarget=null,this._channel0=null,this._batchIndex=0,this.vertexBuffer=new n(65536),this.indexBuffer=new o(32768),this.quadIndexBuffer=new o(49152),this._initQuadIndexBuffer(),this.renderers={sprite:s,line:a,color:h,colorSprite:u}}f.prototype._initQuadIndexBuffer=function(){for(var t=this.quadIndexBuffer.uShortView,e=0,r=0;r<32768;r+=4)t[e]=r,t[e+1]=r+1,t[e+2]=r+2,t[e+3]=r,t[e+4]=r+2,t[e+5]=r+3,e+=6;this.quadIndexBuffer.uploadData()},f.prototype.prepare=function(t,e,r){e&&e._isSprite&&(e=e.img);var i=!1;return e!==this._channel0&&(i=!0),r!==this._renderTarget&&(i=!0),t!==this._renderer&&(i=!0),i&&this.flush(),this._renderer.batcher=null,(t.batcher=this)._renderer=t,this._program=t.program,this._renderTarget=r,this._channel0=e,this._renderer},f.prototype.flush=function(){if(0!==this._batchIndex){var t=this._renderTarget;l.bindFramebuffer(l.FRAMEBUFFER,t.framebuffer),l.viewport(0,0,t.width,t.height);var e=i.useProgram(this._renderer.program);this._renderer.render.call(this,e),this._batchIndex=0}},e.exports=new f},{"./IndexBuffer":13,"./VertexBuffer":14,"./context":16,"./renderers/colorQuad":18,"./renderers/colorSprite":19,"./renderers/line":20,"./renderers/sprite":21}],16:[function(t,e,r){var i=t("../domUtils/createCanvas"),n=t("..").settings,o=n.screen.width,s=n.screen.height,a=n.screen.pixelSize.width,h=n.screen.pixelSize.height,u=i(o,s);u.style.width=o*a+"px",u.style.height=s*h+"px";var l=u.getContext("webgl",{antialias:!1,alpha:!1,depth:!1,failIfMajorPerformanceCaveat:!1,powerPreference:"default",premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1});l.viewport(0,0,u.width,u.height),l.enable(l.BLEND),l.disable(l.DEPTH_TEST),l.depthMask(!1);var f={},c=null;function p(t,e){var r=l.createShader(e);if(l.shaderSource(r,t),l.compileShader(r),!l.getShaderParameter(r,l.COMPILE_STATUS))throw new Error(l.getShaderInfoLog(r));return r}var d=new WeakMap;r.canvas=u,r.gl=l,r.programs=f,r.createProgram=function(t,e,r){if(t&&f[t])return f[t];var i=p(e,l.VERTEX_SHADER),n=p(r,l.FRAGMENT_SHADER),o=l.createProgram();if(l.attachShader(o,i),l.attachShader(o,n),l.linkProgram(o),!l.getProgramParameter(o,l.LINK_STATUS))throw l.deleteProgram(o),new Error(l.getProgramInfoLog(o));return t&&(f[t]=o),o},r.useProgram=function(t){if(c===t)return t;if(null!==c){var e=l.getProgramParameter(c,l.ACTIVE_ATTRIBUTES),r=l.getProgramParameter(t,l.ACTIVE_ATTRIBUTES);if(e<r)for(var i=e;i<r;i++)l.enableVertexAttribArray(i);else if(r<e)for(i=r;i<e;i++)l.disableVertexAttribArray(i)}return c=t,l.useProgram(t),t},r.bindTexture=function(t,e,r,i){var n,o,s;n=e._isGlTexture?e.ctx:(o=e,(s=d.get(o))||(s=l.createTexture(),l.bindTexture(l.TEXTURE_2D,s),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!0),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,o),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),d.set(o,s),s)),l.activeTexture(l.TEXTURE0+i),l.bindTexture(l.TEXTURE_2D,n),l.uniform1i(l.getUniformLocation(t,r),i)}},{"..":11,"../domUtils/createCanvas":8}],17:[function(t,e,r){var o=t("./context"),s=t("./batcher"),a=t(".."),i=a.settings,h=o.gl,u=~~i.screen.width,l=~~i.screen.height,n=new Int16Array([0,l,0,l,u,l,u,l,0,0,0,0,u,l,u,l,u,0,u,0,0,0,0,0]),f=h.createBuffer();function c(t,e){var r=h.getAttribLocation(t,e);return h.enableVertexAttribArray(r),r}h.bindBuffer(h.ARRAY_BUFFER,f),h.bufferData(h.ARRAY_BUFFER,n,h.STATIC_DRAW),r.shaders=o.programs,r.context=o,r.canvas=o.canvas,r.gl=h,r.batcher=s,r.commit=function(){s.flush();var t,e,r,i,n=o.useProgram(o.programs.sprite);h.bindFramebuffer(h.FRAMEBUFFER,null),h.viewport(0,0,u,l),h.bindBuffer(h.ARRAY_BUFFER,f),h.uniform2f(h.getUniformLocation(n,"iChannel0Resolution"),u,l),h.uniform2f(h.getUniformLocation(n,"iResolution"),u,l),h.vertexAttribPointer(c(n,"a_coordinates"),2,h.SHORT,!1,8,0),h.vertexAttribPointer(c(n,"a_uv"),2,h.SHORT,!1,8,4),t=n,e=a.$screen,r="iChannel0",i=0,h.activeTexture(h.TEXTURE0+i),h.bindTexture(h.TEXTURE_2D,e.ctx),h.uniform1i(h.getUniformLocation(t,r),i),h.drawArrays(h.TRIANGLES,0,6)}},{"..":11,"./batcher":15,"./context":16}],18:[function(t,e,r){var i=t("../context"),n=i.gl;function o(){this.batcher=null,this.program=i.createProgram("color",t("../shaders/color.vert"),t("../shaders/color.frag"))}o.prototype.pushRect=function(t,e,r,i,n,o,s){var a=t+r,h=e+i,u=(o<<8)+n,l=this.batcher.vertexBuffer.shortView,f=this.batcher.vertexBuffer.uShortView,c=this.batcher._batchIndex;l[c++]=t,l[c++]=e,f[c++]=u,f[c++]=s,l[c++]=a,l[c++]=e,f[c++]=u,f[c++]=s,l[c++]=a,l[c++]=h,f[c++]=u,f[c++]=s,l[c++]=t,l[c++]=h,f[c++]=u,f[c++]=s,c<32752?this.batcher._batchIndex=c:this.batcher.flush()},o.prototype.render=function(t){this.quadIndexBuffer.bindBuffer(),this.vertexBuffer.uploadData(),n.vertexAttribPointer(n.getAttribLocation(t,"a_coordinates"),2,n.SHORT,!1,8,0),n.vertexAttribPointer(n.getAttribLocation(t,"a_color"),4,n.UNSIGNED_BYTE,!0,8,4),n.uniform2f(n.getUniformLocation(t,"iResolution"),this._renderTarget.width,this._renderTarget.height);var e=this._batchIndex/4/4*6;n.drawElements(n.TRIANGLES,e,n.UNSIGNED_SHORT,0)},e.exports=new o},{"../context":16,"../shaders/color.frag":22,"../shaders/color.vert":23}],19:[function(t,e,r){var i=t("../context"),n=i.gl;function o(){this.batcher=null,this.program=i.createProgram("colorSprite",t("../shaders/colorSprite.vert"),t("../shaders/colorSprite.frag"))}o.prototype.pushSprite=function(t,e,r,i,n,o,s,a,h){var u=t+r,l=e+i,f=n+r,c=o+i,p=(a<<8)+s,d=this.batcher.vertexBuffer.shortView,v=this.batcher.vertexBuffer.uShortView,g=this.batcher._batchIndex;d[g++]=t,d[g++]=e,d[g++]=n,d[g++]=o,v[g++]=p,v[g++]=h,d[g++]=u,d[g++]=e,d[g++]=f,d[g++]=o,v[g++]=p,v[g++]=h,d[g++]=u,d[g++]=l,d[g++]=f,d[g++]=c,v[g++]=p,v[g++]=h,d[g++]=t,d[g++]=l,d[g++]=n,d[g++]=c,v[g++]=p,v[g++]=h,g<32744?this.batcher._batchIndex=g:this.batcher.flush()},o.prototype.render=function(t){this.quadIndexBuffer.bindBuffer(),this.vertexBuffer.uploadData(),n.vertexAttribPointer(n.getAttribLocation(t,"a_coordinates"),2,n.SHORT,!1,12,0),n.vertexAttribPointer(n.getAttribLocation(t,"a_uv"),2,n.SHORT,!1,12,4),n.vertexAttribPointer(n.getAttribLocation(t,"a_color"),4,n.UNSIGNED_BYTE,!0,12,8),n.uniform2f(n.getUniformLocation(t,"iResolution"),this._renderTarget.width,this._renderTarget.height),n.uniform2f(n.getUniformLocation(t,"iChannel0Resolution"),this._channel0.width,this._channel0.height),i.bindTexture(t,this._channel0,"iChannel0",0);var e=this._batchIndex/6/4*6;n.drawElements(n.TRIANGLES,e,n.UNSIGNED_SHORT,0)},e.exports=new o},{"../context":16,"../shaders/colorSprite.frag":24,"../shaders/colorSprite.vert":25}],20:[function(t,e,r){var i=t("../context"),n=i.gl;function o(){this.batcher=null,this.program=i.createProgram("line",t("../shaders/color.vert"),t("../shaders/color.frag"))}o.prototype.pushLines=function(t,e,r,i){},o.prototype.pushRect=function(t,e,r,i,n,o,s){var a=t+r,h=e+i-1;t+=1;var u=(o<<8)+n,l=this.batcher.vertexBuffer,f=l.shortView,c=l.uShortView,p=this.batcher._batchIndex;f[p++]=t,f[p++]=e,c[p++]=u,c[p++]=s,f[p++]=a,f[p++]=e,c[p++]=u,c[p++]=s,f[p++]=a,f[p++]=h,c[p++]=u,c[p++]=s,f[p++]=t,f[p++]=h,c[p++]=u,c[p++]=s,this.batcher._batchIndex=p;var d=this.batcher.indexBuffer,v=d.uShortView,g=(p=d.length,d.vertexIndice);v[p++]=g+0,v[p++]=g+1,v[p++]=g+1,v[p++]=g+2,v[p++]=g+2,v[p++]=g+3,v[p++]=g+3,v[p++]=g+0,d.length=p,d.vertexIndice+=4,32752<=p&&this.batcher.flush()},o.prototype.render=function(t){this.indexBuffer.uploadData(),this.vertexBuffer.uploadData(),n.vertexAttribPointer(n.getAttribLocation(t,"a_coordinates"),2,n.SHORT,!1,8,0),n.vertexAttribPointer(n.getAttribLocation(t,"a_color"),4,n.UNSIGNED_BYTE,!0,8,4),n.uniform2f(n.getUniformLocation(t,"iResolution"),this._renderTarget.width,this._renderTarget.height),n.drawElements(n.LINES,this.indexBuffer.length,n.UNSIGNED_SHORT,0),this.indexBuffer.reset()},e.exports=new o},{"../context":16,"../shaders/color.frag":22,"../shaders/color.vert":23}],21:[function(t,e,r){var i=t("../context"),n=i.gl;function o(){this.batcher=null,this.program=i.createProgram("sprite",t("../shaders/sprite.vert"),t("../shaders/sprite.frag"))}o.prototype.pushSprite=function(t,e,r,i,n,o,s,a,h){var u,l,f,c=n+r,p=o+i,d=this.batcher.vertexBuffer.shortView,v=this.batcher._batchIndex;if(h){u=t+i,l=e+r;var g=n,m=p,x=n,b=o,w=c,_=o,y=c,T=p;s&&(f=m,m=b,b=f,f=T,T=_,_=f),a&&(f=g,g=w,w=f,f=x,x=y,y=f),d[v++]=t,d[v++]=e,d[v++]=g,d[v++]=m,d[v++]=u,d[v++]=e,d[v++]=x,d[v++]=b,d[v++]=u,d[v++]=l,d[v++]=w,d[v++]=_,d[v++]=t,d[v++]=l,d[v++]=y,d[v++]=T}else u=t+r,l=e+i,s&&(f=n,n=c,c=f),a&&(f=o,o=p,p=f),d[v++]=t,d[v++]=e,d[v++]=n,d[v++]=o,d[v++]=u,d[v++]=e,d[v++]=c,d[v++]=o,d[v++]=u,d[v++]=l,d[v++]=c,d[v++]=p,d[v++]=t,d[v++]=l,d[v++]=n,d[v++]=p;v<32752?this.batcher._batchIndex=v:this.batcher.flush()},o.prototype.render=function(t){this.quadIndexBuffer.bindBuffer(),this.vertexBuffer.uploadData(),n.vertexAttribPointer(n.getAttribLocation(t,"a_coordinates"),2,n.SHORT,!1,8,0),n.vertexAttribPointer(n.getAttribLocation(t,"a_uv"),2,n.SHORT,!1,8,4),n.uniform2f(n.getUniformLocation(t,"iResolution"),this._renderTarget.width,this._renderTarget.height),n.uniform2f(n.getUniformLocation(t,"iChannel0Resolution"),this._channel0.width,this._channel0.height),i.bindTexture(t,this._channel0,"iChannel0",0);var e=this._batchIndex/4/4*6;n.drawElements(n.TRIANGLES,e,n.UNSIGNED_SHORT,0)},e.exports=new o},{"../context":16,"../shaders/sprite.frag":26,"../shaders/sprite.vert":27}],22:[function(t,e,r){e.exports="precision mediump float;\n\nvarying vec4 iColor;\n\nvoid main() {\n\tvec4 color = iColor;\n\tcolor.a = 1.0;\n\tgl_FragColor = color;\n}\n"},{}],23:[function(t,e,r){e.exports="uniform   vec2 iResolution;\nattribute vec2 a_coordinates;\nattribute vec4 a_color;\nvarying   vec4 iColor;\n\nvoid main(void) {\n\tgl_Position = vec4(\n\t\ta_coordinates.x *  2.0 / iResolution.x - 1.0,\n\t\ta_coordinates.y * -2.0 / iResolution.y + 1.0,\n\t\t0.0,\n\t\t1.0\n\t);\n\tiColor = a_color;\n}\n"},{}],24:[function(t,e,r){e.exports="precision mediump float;\n\nuniform sampler2D iChannel0;\nvarying vec2 fragCoord;\nvarying vec4 iColor;\n\nvoid main(void) {\n\tvec4 color = texture2D(iChannel0, fragCoord);\n\tif (color.r == 0.0) discard;\n\tgl_FragColor = iColor;\n}\n"},{}],25:[function(t,e,r){e.exports="uniform   vec2 iResolution;\nuniform   vec2 iChannel0Resolution;\nattribute vec2 a_coordinates;\nattribute vec2 a_uv;\nattribute vec4 a_color;\nvarying   vec2 fragCoord;\nvarying   vec4 iColor;\n\nvoid main(void) {\n\tgl_Position = vec4(\n\t\ta_coordinates.x *  2.0 / iResolution.x - 1.0,\n\t\ta_coordinates.y * -2.0 / iResolution.y + 1.0,\n\t\t0.0,\n\t\t1.0\n\t);\n\tfragCoord = vec2(a_uv.x / iChannel0Resolution.x, 1.0 - a_uv.y / iChannel0Resolution.y);\n\tiColor = vec4(a_color.rgb, 1.0);\n}\n"},{}],26:[function(t,e,r){e.exports="precision mediump float;\n\nuniform sampler2D iChannel0;\nvarying vec2 fragCoord;\n\nvoid main(void) {\n\tvec4 color = texture2D(iChannel0, fragCoord);\n\tif (color.a == 0.0) discard;\n\tgl_FragColor = color;\n}\n"},{}],27:[function(t,e,r){e.exports="uniform   vec2 iResolution;\nuniform   vec2 iChannel0Resolution;\nattribute vec2 a_coordinates;\nattribute vec2 a_uv;\nvarying   vec2 fragCoord;\n\nvoid main(void) {\n\tgl_Position = vec4(\n\t\ta_coordinates.x *  2.0 / iResolution.x - 1.0,\n\t\ta_coordinates.y * -2.0 / iResolution.y + 1.0,\n\t\t0.0,\n\t\t1.0\n\t);\n\tfragCoord = vec2(a_uv.x / iChannel0Resolution.x, 1.0 - a_uv.y / iChannel0Resolution.y);\n}\n"},{}],28:[function(t,e,r){var i=t("pixelbox/domUtils"),n=settings.screen.width,o=settings.screen.height,s=4,a=[],h=new Stats;h.domElement.className="stats",document.body.appendChild(h.domElement);var u=i.createDiv("bunniesCounter",h.domElement);function l(){this.x=Math.random()*n,this.y=Math.random()*o,this.sx=(Math.random()-.5)*s,this.sy=(Math.random()-.5)*s}function f(t){for(var e=0;e<t;e++)a.push(new l);u.innerText="bunnies: "+a.length}f(1e3),r.update=function(){cls();for(var t=0;t<a.length;t++){var e=a[t];e.x+=e.sx,e.y+=e.sy,(e.x>n&&0<e.sx||e.x<0&&e.sx<0)&&(e.sx*=-1),(e.y>o&&0<e.sy||e.y<0&&e.sy<0)&&(e.sy*=-1),draw(assets.bunny,e.x,e.y)}btn.A&&(f(1e3),console.log(a.length)),h.update()}},{"pixelbox/domUtils":9}],29:[function(d,t,e){var r,i,f=d("."),n={dat:{bunny:null,tilesheet:null,maps:{_type:"maps",maps:[{w:16,h:16,name:"map",sheet:"",data:"###$#%#&#'#(#)#*#+#,#-#~#/#0#1#2#3#4#5#6#7#8#9#:#;#<#=#>#?#@#A#B#C#D#E#F#G#H#I#J#K#L#M#N#O#P#Q#R%Y%Z%[%]%^%_%`%a%b%c%d%e%f%g%h%i!!|[#$#%#$!!|,$g|,!!|D#2!!|8#3#4|,#5!!|/$`!!|0#C#D|,#E!!|/##|,!!|,##!!|,#C#D|,#E!!|~##|-!!|,##|,!!#C#D|,#E!!|-##|~!!|,##|,#7|6!!|,#7|,#G|6!!|,#G|,"}]}},root:"assets/",img:["bunny.png","tilesheet.png"],snd:[],settings:{name:"bunnymark",version:"2.0.2",screen:{width:900,height:500,pixelSize:{width:1,height:1},fullscreen:!1},tileSize:{width:8,height:8},palette:{colors:["#000000","#FFF1E8","#008751","#AB5236","#7E2553","#5F574F","#29ADFF","#00E756","#FFA300","#FF77A8","#C2C3C7","#83769C","#FFFF27","#FFCCAA","#1D2B53","#FF004D"]},controls:{up:38,down:40,left:37,right:39,A:32,B:88},touchEvent:{multiTouch:!1,disableContextMenu:!1,hideMousePointer:!1},appid:"ESTsLdoAzuL2L7Rx",loader:{colors:["#FFF1E8","#000000"]},gamepad:{}}},v=f.settings=n.settings,o=d("./assetLoader");function s(){r.resume(),document.body.removeEventListener("mousedown",s),document.body.removeEventListener("touchstart",s)}f.inherits=d("./inherits"),f.setFullScreen=function(){},r=null,i=window.AudioContext||window.webkitAudioContext,window.AudioContext=window.webkitAudioContext=function(){return r||(r=new i,document.body.addEventListener("mousedown",s),document.body.addEventListener("touchstart",s),r)};var a,h=f.btn={},u=f.btnp={},l=f.btnr={},c={},p=[],g=0;function m(){for(var t=0;t<g;t++)u[p[t]]=!1,l[p[t]]=!1}function x(t,e){var r=c[t];r&&(e&&!h[r]&&(u[r]=!0),!e&&h[r]&&(l[r]=!0),h[r]=e)}!function(){var t=v.controls||{up:38,down:40,left:37,right:39,A:32,B:88};for(var e in t)c[t[e]]=e,h[e]=!1,u[e]=!1,l[e]=!1,p.push(e);g=p.length}(),window.addEventListener("keydown",function(t){t.preventDefault(),t.repeat||x(t.keyCode,!0)}),window.addEventListener("keyup",function(t){t.preventDefault(),x(t.keyCode,!1)}),f.chr$=function(t){return String.fromCharCode(t)},f.clamp=function(t,e,r){return Math.max(e,Math.min(r,t))},f.random=function(t,e){return void 0===e?~~(t*Math.random()):~~(t+Math.random()*(e-t))};var b=d("./Texture"),w=d("./TileMap");a=d("./webGL"),d("./Texture/webGL"),d("./TileMap/webGL"),d("./Texture/textWebGL");var _=v.tileSize.width,y=v.tileSize.height;b.setTileSize(_,y),w.setTileSize(_,y),f.texture=function(t){var e=new b(t.width,t.height);return e.clear().draw(t,0,0),e},f.tilesheet=function(t){return b.prototype.setGlobalTilesheet(t)};var T=function(){var t=v.screen,h=t.width,u=t.height,l=t.pixelSize,e=f.$screen=new b(h,u);e.canvas=a.context.canvas;var r=e.canvas,i=r.style;if(document.body.appendChild(r),t.fullscreen)if(t.keepAspectRatio){function n(){var t=window.innerWidth,e=window.innerHeight,r=h*l.width,i=u*l.height,n=Math.min(t/r,e/i),o=r*n,s=i*n,a=f.$screen.canvas.style;a.width=o+"px",a.height=s+"px",a.left=(t-o)/2+"px",a.top=(e-s)/2+"px"}addEventListener("resize",n),n()}else i.width=i.height="100%";else i.width=h*l.width+"px",i.height=u*l.height+"px";return e}();f.cls=function(){return T.cls()},f.sprite=function(t,e,r,i,n,o){return T.sprite(t,e,r,i,n,o)},f.draw=function(t,e,r,i,n,o){return T.draw(t,e,r,i,n,o)},f.rect=function(t,e,r,i){return T.rect(t,e,r,i)},f.rectf=function(t,e,r,i){return T.rectf(t,e,r,i)},f.camera=function(t,e){return T.setCamera(t,e)},f.pen=function(t){return T.pen(t)},f.paper=function(t){return T.paper(t)},f.locate=function(t,e){return T.locate(t,e)},f.print=function(t,e,r){return T.print(t,e,r)},f.println=function(t){return T.println(t)},f.getMap=w.getMap,f.rectfill=f.rectf;var E=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1/60)};window.frameId=0;var R=~~(v.screen.width/2),A=~~(v.screen.width/4),S=~~(v.screen.height/2);var C=["#000","#FFF"],B=v.loader&&v.loader.colors||v.loaderColors||C;Array.isArray(B)||(B=C);var F=d("./Color");T.setPalette([(new F).fromString(B[0]),(new F).fromString(B[1])]),T.paper(0).cls().paper(1).pen(1).rect(R-A-2,S-4,2*A+4,8),a.commit(),o.preloadStaticAssets(n,function(t,p){if(T.paper(0).pen(1).cls(),t)return console.error(t),void print(t);for(var e in f.assets=p,f)window[e]=f[e];(function(){var t=d("./Color"),e=v.palette;if(e.file){for(var r=e.file.split("/"),i=p;i&&r.length;)i=i[r.shift()];if(!i)return;var n=i.width,o=i.height,s=i.x||0,a=i.y||0;i._isSprite&&(i=i.img);var h=d("./domUtils/createCanvas")(n,o).getContext("2d");h.drawImage(i,s,a,n,o,0,0,n,o);for(var u=h.getImageData(0,0,n,o).data,l=[],f=0;f<u.length;f+=4)u[f+3]<=1||l.push((new t).fromPixel(u,f));T.setPalette(l)}else{var c;for(c=e.colors?e.colors:e,l=[],f=0;f<c.length;f++)l.push((new t).fromString(c[f]));T.setPalette(l)}})(),p.tilesheet&&f.tilesheet(p.tilesheet),w.loadBank(p.maps);var r=d("./gamepad"),i=v.gamepad||{};i.analogToDpad&&r.mapAnalogStickToDpad(i.deadZone);var n=d("../../src/main.js");n.update?(a.batcher.flush(),m(),function t(){window.frameId+=1,r.update(),n.update(),m(),a.commit(),E(t)}()):function t(){a.commit(),E(t)}()},function(t,e,r,i){T.rect(R-A-2,S-4,2*A+4,8).rectf(R-A,S-2,~~(i*A*2),4),a.commit()})},{".":11,"../../src/main.js":28,"./Color":1,"./Texture":2,"./Texture/textWebGL":3,"./Texture/webGL":4,"./TileMap":5,"./TileMap/webGL":6,"./assetLoader":7,"./domUtils/createCanvas":8,"./gamepad":10,"./inherits":12,"./webGL":17}]},{},[29]);